<form [formGroup]="form" (ngSubmit)="OnSubmit()" class="needs-validation" novalidate>
  <nb-card accent="success" [nbSpinner]="loading" >

    <nb-card-header>
      Gerar Boletos Mensais
    </nb-card-header>

    <nb-card-body>

      <div class="row">

        <div class="col-md-3 col-12">
          <div class="form-group">

            <label class="label">* Referência:</label>
            <input
              nbInput
              fullWidth
              type="text"
              class="form-control"
              [mask]="'00/0000'"
              [status]="getStatus('referencia')"
              [ngClass]="{'is-valid': (referencia.valid && submited) , 'is-invalid' : (referencia.invalid && submited)  }"
              [formControl]="referencia"
              placeholder="Referência"
            >

            <div class="valid-feedback" >
              Válido
            </div>

            <div class="invalid-feedback" >
              Inválido
            </div>

          </div>
        </div>

        <div class=" col-md-3 col-12">
          <div class="form-group">

            <label class="label">* Vencimento:</label>
            <input
              nbInput
              fullWidth
              type="text"
              class="form-control"
              [mask]="'00/00/0000'"
              [status]="getStatus('vencimento')"
              [ngClass]="{'is-valid': (vencimento.valid && submited) , 'is-invalid' : (vencimento.invalid && submited)  }"
              [formControl]="vencimento"
              placeholder="vencimento"
            >

            <div class="valid-feedback" >
              Válido
            </div>

            <div class="invalid-feedback" >
              Inválido
            </div>

          </div>
        </div>

        <div class="col-md-3 offset-md-3 col-12">
          <div class="form-group">
            <label class="label">Ações</label>
            <button nbButton outline fullWidth status="success" type="submit">Pré-Visualizar</button>
          </div>
        </div>

      </div>


    </nb-card-body>

  </nb-card>
</form>


<nb-card accent="success" *ngIf="contratos" [nbSpinner]="loading" >

  <nb-card-body>
    <label class="label">Refêrencia </label>

    <div class="col-12">
      <div class="row">
        <table class="table table-sm table-striped">

          <thead>
            <tr>
              <th scope="col" class="align-middle font-weight-bold"> Nome: </th>
              <th scope="col" class="align-middle font-weight-bold"> Matrícula: </th>
              <th scope="col" class="align-middle font-weight-bold"> Valor: </th>
              <th scope="col" class="align-middle font-weight-bold">
              </th>
            </tr>
          </thead>

          <tbody>

            <tr *ngFor="let c of contratos">
              <td class="align-middle">
                {{c.cliente.nome}}
              </td>

              <td class="align-middle">
                {{c.matricula.logradouro.tipoLogradouro.nome}}
                {{c.matricula.logradouro.nome}}
                {{c.matricula.numero}}
                {{c.matricula.letra}}
              </td>

              <td class="align-middle">
                {{c.valor  |  currency:'BRL':'symbol'}}
              </td>

              <td class="align-middle">
                <nb-checkbox [(ngModel)]=c.check class="align-center">
                </nb-checkbox>
              </td>

            </tr>

            <tr *ngIf="!contratos?.length">
              <td class="align-middle" colspan="3" >
                Nenhum registro encontrado
              </td>
            </tr>

          </tbody>

        </table>
      </div>
    </div>

  </nb-card-body>

  <nb-card-footer>
    <div class="row">

      <div class="offset-md-9 col-md-3 col-12">
        <button nbButton outline fullWidth status="basic" (click)=gerar()>Gerar</button>
      </div>

    </div>
  </nb-card-footer>

</nb-card>
