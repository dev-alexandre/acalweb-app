!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{TP08:function(t,r,a){"use strict";a.r(r),a.d(r,"HidrometroModule",(function(){return F}));var o,i,l=a("3Pt+"),c=a("oG2T"),d=a("tR1z"),s=a("aceb"),m=a("BxTH"),u=a("vTDv"),f=a("tmjD"),h=a("j9oM"),p=a("fXoL"),v=a("tyNb"),b=((o=function(){function t(){e(this,t)}return n(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(e){return new(e||o)},o.\u0275cmp=p["\u0275\u0275defineComponent"]({type:o,selectors:[["ngx-hidrometro"]],decls:1,vars:0,template:function(e,t){1&e&&p["\u0275\u0275element"](0,"router-outlet")},directives:[v.h],encapsulation:2}),o),g=a("wd/R"),S=a("ofXK"),E=a("vDW2"),y=((i=function(){function t(){e(this,t)}return n(t,[{key:"transform",value:function(e,t){return e?e.letra?e.logradouro.tipoLogradouro.nome+" "+e.logradouro.nome+" "+e.letra+" "+e.numero:e.logradouro.tipoLogradouro.nome+" "+e.logradouro.nome+" "+e.numero:""}}]),t}()).\u0275fac=function(e){return new(e||i)},i.\u0275pipe=p["\u0275\u0275definePipe"]({name:"matricula",type:i,pure:!0}),i);function x(e,t){if(1&e){var n=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"tr"),p["\u0275\u0275elementStart"](1,"td",14),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"matricula"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"td",14),p["\u0275\u0275elementStart"](5,"input",15),p["\u0275\u0275listener"]("ngModelChange",(function(e){return p["\u0275\u0275restoreView"](n),t.$implicit.hidrometro.anterior=e})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](6,"td",14),p["\u0275\u0275elementStart"](7,"input",16),p["\u0275\u0275listener"]("ngModelChange",(function(e){return p["\u0275\u0275restoreView"](n),t.$implicit.hidrometro.atual=e})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit;p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](3,5,r.matricula)," "),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("status",r.valido?"basic":"danger")("ngModel",r.hidrometro.anterior),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("status",r.valido?"basic":"danger")("ngModel",r.hidrometro.atual)}}function M(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"tbody"),p["\u0275\u0275template"](1,x,8,7,"tr",13),p["\u0275\u0275elementEnd"]()),2&e){var n=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngForOf",n.hidrometros)}}var w,O,k,C,P,I,R,_=((k=function(){function t(n,r,a,o){e(this,t),this.toast=n,this.matriculaService=r,this.activeRouter=a,this.router=o,this.storage=sessionStorage}return n(t,[{key:"ngOnInit",value:function(){this.load(),this.loadData()}},{key:"load",value:function(){this.referencia=JSON.parse(this.storage.getItem("[hidrometro][adicionar]")),this.storage.removeItem("[hidrometro][adicionar]"),this.referencia||this.router.navigate(["./listar"],{relativeTo:this.activeRouter.parent}),this.referenciaAnterior=this.getReferenciaAnterior(this.referencia)}},{key:"getReferenciaAnterior",value:function(e){return g(g(e,"MMYYYY",!0)).subtract(1,"M").format("MMYYYY")}},{key:"loadData",value:function(){var e=this;this.hidrometros=[],this.matriculaService.listarMatriculasHidrometro().subscribe((function(t){e.matriculas=t,e.matriculas.forEach((function(t){var n=e.hidrometroByReferencia(t,e.referencia);if(!n){var r=e.hidrometroByReferencia(t,e.referenciaAnterior);n=r?{referencia:e.referencia,atual:0,anterior:r.atual}:{referencia:e.referencia,atual:0,anterior:0}}e.hidrometros.push({matricula:t,hidrometro:n,valido:!0})}))}))}},{key:"validar",value:function(){return this.hidrometros.forEach((function(e){e.hidrometro.atual<e.hidrometro.anterior&&(e.valido=!1)})),this.hidrometros.some((function(e){return!e.valido}))}},{key:"hidrometroByReferencia",value:function(e,t){return e.hidrometroList||(e.hidrometroList=[]),e.hidrometroList.find((function(e){return e.referencia===t}))}},{key:"salvar",value:function(){var e=this;this.validar()?this.toast.danger("Erro","Dados invalidos"):(this.hidrometros.forEach((function(e){e.matricula.hidrometroList.push(e.hidrometro)})),this.matriculaService.salvarTodos(this.matriculas).subscribe((function(){e.router.navigate(["./listar"],{relativeTo:e.activeRouter.parent})}),(function(){})))}},{key:"voltar",value:function(){this.router.navigate(["./listar"],{relativeTo:this.activeRouter.parent})}}]),t}()).\u0275fac=function(e){return new(e||k)(p["\u0275\u0275directiveInject"](s.Fb),p["\u0275\u0275directiveInject"](h.a),p["\u0275\u0275directiveInject"](v.a),p["\u0275\u0275directiveInject"](v.c))},k.\u0275cmp=p["\u0275\u0275defineComponent"]({type:k,selectors:[["ngx-hidrometro-adicionar"]],decls:30,vars:4,consts:[["accent","success"],[1,"float-left"],[1,"float-right"],[1,"table-responsive"],[1,"table","table-sm","table-striped"],["scope","col",1,"align-middle","font-weight-bold"],[4,"ngIf"],["scope","col","colspan","3"],[1,"row"],[1,"col-md-2","col-6"],["nbButton","","outline","","fullWidth","","status","basic","type","button",3,"click"],[1,"col-md-2","offset-md-8","col-6"],["nbButton","","outline","","fullWidth","","status","success","type","submit",3,"click"],[4,"ngFor","ngForOf"],[1,"align-middle"],["nbInput","","fullWidth","","type","text","mask","separator.0","thousandSeparator",".","placeholder","Anterior",3,"status","ngModel","ngModelChange"],["nbInput","","fullWidth","","type","text","mask","separator.0","thousandSeparator",".","placeholder","Atual",3,"status","ngModel","ngModelChange"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"nb-card",0),p["\u0275\u0275elementStart"](1,"nb-card-header"),p["\u0275\u0275elementStart"](2,"div",1),p["\u0275\u0275text"](3," Registro "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"div",2),p["\u0275\u0275text"](5),p["\u0275\u0275pipe"](6,"referenciaPipe"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](7,"nb-card-body"),p["\u0275\u0275elementStart"](8,"div",3),p["\u0275\u0275elementStart"](9,"table",4),p["\u0275\u0275elementStart"](10,"thead"),p["\u0275\u0275elementStart"](11,"tr"),p["\u0275\u0275elementStart"](12,"th",5),p["\u0275\u0275text"](13," Matr\xedcula: "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](14,"th",5),p["\u0275\u0275text"](15," Anterior: "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](16,"th",5),p["\u0275\u0275text"](17," Atual: "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](18,M,2,1,"tbody",6),p["\u0275\u0275elementStart"](19,"tfoot"),p["\u0275\u0275elementStart"](20,"tr"),p["\u0275\u0275element"](21,"th",7),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](22,"nb-card-footer"),p["\u0275\u0275elementStart"](23,"div",8),p["\u0275\u0275elementStart"](24,"div",9),p["\u0275\u0275elementStart"](25,"button",10),p["\u0275\u0275listener"]("click",(function(){return t.voltar()})),p["\u0275\u0275text"](26,"voltar"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](27,"div",11),p["\u0275\u0275elementStart"](28,"button",12),p["\u0275\u0275listener"]("click",(function(){return t.salvar()})),p["\u0275\u0275text"](29,"Salvar"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275advance"](5),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](6,2,t.referencia)," "),p["\u0275\u0275advance"](13),p["\u0275\u0275property"]("ngIf",t.hidrometros))},directives:[s.v,s.x,s.u,S.n,s.w,s.s,S.m,s.O,f.a,l.b,l.q,l.t],pipes:[E.a,y],styles:[".nb-theme-default   [_nghost-%COMP%]   table.table[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;color:#222b45}.nb-theme-cosmic   [_nghost-%COMP%]   table.table[_ngcontent-%COMP%], .nb-theme-dark   [_nghost-%COMP%]   table.table[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;color:#fff}.nb-theme-corporate   [_nghost-%COMP%]   table.table[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;color:#222b45}"]}),k),j=((O=function t(){e(this,t)}).\u0275fac=function(e){return new(e||O)},O.\u0275cmp=p["\u0275\u0275defineComponent"]({type:O,selectors:[["ngx-hidrometro-deletar"]],decls:12,vars:0,consts:[["status","danger"],[1,"row"],[1,"col-md-2","col-6"],["nbButton","","outline","","fullWidth","","status","basic"],[1,"col-md-2","offset-md-8","col-6"],["nbButton","","outline","","fullWidth","","status","danger","type","button"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"nb-card",0),p["\u0275\u0275elementStart"](1,"nb-card-header"),p["\u0275\u0275text"](2," Hidr\xf4metro "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](3,"nb-card-body"),p["\u0275\u0275elementStart"](4,"nb-card-footer"),p["\u0275\u0275elementStart"](5,"div",1),p["\u0275\u0275elementStart"](6,"div",2),p["\u0275\u0275elementStart"](7,"button",3),p["\u0275\u0275text"](8,"voltar"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](9,"div",4),p["\u0275\u0275elementStart"](10,"button",5),p["\u0275\u0275text"](11,"Deletar"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]())},directives:[s.v,s.x,s.u,s.w,s.s],encapsulation:2}),O),B=((w=function t(){e(this,t)}).\u0275fac=function(e){return new(e||w)},w.\u0275cmp=p["\u0275\u0275defineComponent"]({type:w,selectors:[["ngx-hidrometro-editar"]],decls:16,vars:0,consts:[["novalidate","",1,"needs-validation"],["status","warning"],[1,"row"],[1,"col-md-3","col-12"],[1,"form-group"],[1,"col-md-2","col-6"],["nbButton","","outline","","fullWidth","","status","basic","type","reset"],[1,"col-md-2","offset-md-8","col-6"],["nbButton","","outline","","fullWidth","","status","success","type","submit"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"form",0),p["\u0275\u0275elementStart"](1,"nb-card",1),p["\u0275\u0275elementStart"](2,"nb-card-header"),p["\u0275\u0275text"](3," Hidr\xf4metro "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"nb-card-body"),p["\u0275\u0275elementStart"](5,"div",2),p["\u0275\u0275elementStart"](6,"div",3),p["\u0275\u0275element"](7,"div",4),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](8,"nb-card-footer"),p["\u0275\u0275elementStart"](9,"div",2),p["\u0275\u0275elementStart"](10,"div",5),p["\u0275\u0275elementStart"](11,"button",6),p["\u0275\u0275text"](12,"voltar"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](13,"div",7),p["\u0275\u0275elementStart"](14,"button",8),p["\u0275\u0275text"](15,"Salvar"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]())},directives:[l.B,l.r,l.s,s.v,s.x,s.u,s.w,s.s],encapsulation:2}),w),W=a("FPPW"),T=((C=function t(){e(this,t)}).\u0275fac=function(e){return new(e||C)},C.\u0275prov=p["\u0275\u0275defineInjectable"]({token:C,factory:C.\u0275fac}),C),A=[{path:"",component:b,children:[{path:"listar",component:(P=function(){function t(n,r,a){e(this,t),this.router=n,this.activeRouter=r,this.service=a,this.storage=sessionStorage,this.submited=!1}return n(t,[{key:"ngOnInit",value:function(){this.loadForm()}},{key:"loadForm",value:function(){this.form=new l.h({referencia:new l.e(null,[l.z.required,l.z.minLength(6),l.z.maxLength(6),W.a.isReferencia()])})}},{key:"OnSubmit",value:function(){this.submited=!0,this.form.invalid||(this.storage.setItem("[hidrometro][adicionar]",JSON.stringify(this.referencia.value)),this.router.navigate(["./adicionar"],{relativeTo:this.activeRouter.parent}))}},{key:"getStatus",value:function(e){return this.submited?this.form.get(e).valid?"success":"danger":"basic"}},{key:"referencia",get:function(){return this.form.get("referencia")}}]),t}(),P.\u0275fac=function(e){return new(e||P)(p["\u0275\u0275directiveInject"](v.c),p["\u0275\u0275directiveInject"](v.a),p["\u0275\u0275directiveInject"](T))},P.\u0275cmp=p["\u0275\u0275defineComponent"]({type:P,selectors:[["ngx-hidrometro-listar"]],decls:21,vars:4,consts:[[1,"needs-validation",3,"formGroup","ngSubmit"],["accent","success"],[1,"row"],[1,"col-md-3","col-12"],[1,"form-group"],[1,"label"],["nbInput","","fullWidth","","type","text","placeholder","Refer\xeancia",1,"form-control",3,"mask","formControl","status"],[1,"valid-feedback"],[1,"invalid-feedback"],[1,"col-md-3","offset-md-3","col-12"],["nbButton","","outline","","fullWidth","","status","success","type","submit"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"form",0),p["\u0275\u0275listener"]("ngSubmit",(function(){return t.OnSubmit()})),p["\u0275\u0275elementStart"](1,"nb-card",1),p["\u0275\u0275elementStart"](2,"nb-card-header"),p["\u0275\u0275text"](3," Hidrom\xeatros "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"nb-card-body"),p["\u0275\u0275elementStart"](5,"div",2),p["\u0275\u0275elementStart"](6,"div",3),p["\u0275\u0275elementStart"](7,"div",4),p["\u0275\u0275elementStart"](8,"label",5),p["\u0275\u0275text"](9,"* Refer\xeancia:"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](10,"input",6),p["\u0275\u0275elementStart"](11,"div",7),p["\u0275\u0275text"](12," V\xe1lido "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](13,"div",8),p["\u0275\u0275text"](14," Inv\xe1lido "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](15,"div",9),p["\u0275\u0275elementStart"](16,"div",4),p["\u0275\u0275elementStart"](17,"label",5),p["\u0275\u0275text"](18,"A\xe7\xf5es"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](19,"button",10),p["\u0275\u0275text"](20,"Pr\xe9-Visualizar"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275property"]("formGroup",t.form),p["\u0275\u0275advance"](10),p["\u0275\u0275property"]("mask","00/0000")("formControl",t.referencia)("status",t.getStatus("referencia")))},directives:[l.B,l.r,l.i,s.v,s.x,s.u,s.O,f.a,l.b,l.q,l.f,s.s],styles:[".nb-theme-default   [_nghost-%COMP%]   table.table[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;color:#222b45}.nb-theme-cosmic   [_nghost-%COMP%]   table.table[_ngcontent-%COMP%], .nb-theme-dark   [_nghost-%COMP%]   table.table[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;color:#fff}.nb-theme-corporate   [_nghost-%COMP%]   table.table[_ngcontent-%COMP%]{font-family:Open Sans,sans-serif;color:#222b45}"]}),P)},{path:"adicionar",component:_},{path:"deletar",component:j},{path:"editar",component:B}]}],L=((R=function t(){e(this,t)}).\u0275mod=p["\u0275\u0275defineNgModule"]({type:R}),R.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(e){return new(e||R)},imports:[[v.g.forChild(A)],v.g]}),R),F=((I=function t(){e(this,t)}).\u0275mod=p["\u0275\u0275defineNgModule"]({type:I}),I.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(e){return new(e||I)},providers:[h.a,T],imports:[[u.a,s.y,s.t,s.P,s.mb,d.a,s.M,l.k,l.w,s.P,L,s.F,c.a,m.a,s.Ib,f.c.forChild()]]}),I)}}])}();